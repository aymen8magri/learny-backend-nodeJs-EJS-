<!-- ============================ Page Title Start ================================== -->
<section class="call-to-act" style="background:#0b85ec url(/img/landing-bg.png) no-repeat">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-lg-12 col-md-12">
        <h2 class="text-light">Liste des Stagiaires</h2>
        <span class="ipn-subtitle text-light">
          Dashboard Responsable — <span style="color:#0c0101; font-weight:600;">Gestion des stagiaires</span>
        </span>
      </div>
    </div>
  </div>
</section>
<!-- ============================ Page Title End ================================== -->

<!-- ============================ Main Section Start ================================== -->
<section class="gray-bg">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">

        <!-- Message Flash -->
        <% if (success && success.length > 0) { %>
          <div class="alert alert-success alert-dismissible fade show mt-3 text-center" role="alert">
            <strong><i class="fa fa-check-circle"></i> <%= success %></strong>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Fermer"></button>
          </div>
        <% } %>
        <% if (error && error.length > 0) { %>
          <div class="alert alert-danger alert-dismissible fade show mt-3 text-center" role="alert">
            <strong><i class="fa fa-times-circle"></i> <%= error %></strong>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Fermer"></button>
          </div>
        <% } %>

        <% if (stagiaires.length === 0) { %>
          <div class="alert alert-info mt-4 text-center">
            Aucun stagiaire enregistré pour le moment.
          </div>
        <% } else { %>

          <!-- Barre de recherche -->
          <div class="d-flex justify-content-between align-items-center mb-4 mt-3">
            <div class="input-group w-auto">
              <input type="text" id="searchInput" class="form-control" placeholder="Rechercher par nom ou email...">
              <button class="btn btn-primary"><i class="fa fa-search"></i></button>
            </div>
          </div>

          <table class="table table-striped table-bordered align-middle">
            <thead class="thead-dark">
              <tr class="text-center">
                <th>Photo</th>
                <th>Prénom</th>
                <th>Nom</th>
                <th>Email</th>
                <th>Téléphone</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="stagiairesTable">
              <% stagiaires.forEach(s => { %>
                <tr class="text-center stagiaire-row">
                  <td>
                    <img src="<%= s.photo || '/img/co-4.jpg' %>" 
                         class="img-fluid rounded-circle" 
                         width="50" alt="Photo profil">
                  </td>
                  <td><%= s.lastName %></td>
                  <td><%= s.firstName %></td>
                  <td><%= s.email %></td>
                  <td><%= s.phone || 'N/A' %></td>
                  <td>
                    <form action="/stagiaires/<%= s._id %>" method="POST"
                          onsubmit="return confirm('Voulez-vous vraiment supprimer ce stagiaire ?');">
                      <button class="btn btn-danger btn-sm" title="Supprimer">
                        <i class="fa fa-trash"></i>
                      </button>
                    </form>
                  </td>
                </tr>
              <% }) %>
            </tbody>
          </table>
        <% } %>

      </div>
    </div>
  </div>
</section>
<!-- ============================ Main Section End ================================== -->

<!-- Script recherche -->
<script>
  document.getElementById('searchInput').addEventListener('keyup', function() {
    const filter = this.value.toLowerCase();
    const rows = document.querySelectorAll('.stagiaire-row');
    rows.forEach(row => {
      const text = row.textContent.toLowerCase();
      row.style.display = text.includes(filter) ? '' : 'none';
    });
  });
</script>

<style>
  .alert {
    border-radius: 10px;
  }
  .alert-success {
    border: 2px solid #198754;
    box-shadow: 0 0 10px rgba(25, 135, 84, 0.3);
  }
  .alert-danger {
    border: 2px solid #dc3545;
    box-shadow: 0 0 10px rgba(220, 53, 69, 0.3);
  }
</style>
